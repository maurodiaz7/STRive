!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).reorder={})}(this,(function(t){"use strict";function e(t,e,n=1){arguments.length<2&&(e=t,t=0);const r=[];let o=t;if(n<0)for(;o>e;o+=n)r.push(o);else for(;o<e;o+=n)r.push(o);return r}const n=e;function r(t,e){const n=e?Array(t.length):{};for(let e=0;e<t.length;e++)n[t[e]]=e;return n}function o(t,e,n,r){const o=t.inEdges(e),l=t.inEdges(n);let i=0;for(let t=0;t<l.length;t++){const e=r[l[t].target.index];for(let t=0;t<o.length;t++)r[o[t].target.index]>e&&i++}return i}function l(t,e,n,r){const o=t.outEdges(e),l=t.outEdges(n);let i=0;for(let t=0;t<l.length;t++){const e=r[l[t].source.index];for(let t=0;t<o.length;t++)r[o[t].source.index]>e&&i++}return i}function i(t,e){return t-e}function f(t){return"function"==typeof t?t:function(){return t}}function s(t,e){var n,r;(t=Math.abs(t))>(e=Math.abs(e))?(n=t,r=e):(n=e,r=t);var o=r/n;return n*Math.sqrt(1+o*o)}function a(t){var e=-1,n=[];if(1===arguments.length)for(;++e<t;)n[e]=0;else for(;++e<t;)n[e]=a.apply(this,Array.prototype.slice.call(arguments,1));return n}function c(t,e,n,r){var o,l;return Math.abs(n)>Math.abs(r)?[(t+(o=r/n)*e)/(l=n+o*r),(e-o*t)/l]:[((o=n/r)*t+e)/(l=r+o*n),(o*e-t)/l]}function u(t,e){for(var n=0,r=-1,o=Math.min(t.length,e.length);++r<o;)n+=t[r]*e[r];return n}function h(t,e){e||(e=1e-10);for(var n,r,o=t.length,l=t[0].length,i=-1;++i<o;){var f=i;for(n=i;++n<o;)Math.abs(t[n][i])>Math.abs(t[f][i])&&(f=n);var s=t[i];if(t[i]=t[f],t[f]=s,Math.abs(t[i][i])<=e)return!1;for(n=i;++n<o;){var a=t[n][i]/t[i][i];for(r=i-1;++r<l;)t[n][r]-=t[i][r]*a}}for(i=o;--i>=0;){a=t[i][i];for(n=-1;++n<i;)for(r=l;--r>=i;)t[n][r]-=t[i][r]*t[n][i]/a;for(t[i][i]/=a,r=o-1;++r<l;)t[i][r]/=a}return!0}function g(t){return Math.sqrt(u(t,t))}var d=Object.freeze({cross:function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},decompose:function(){return function(t){for(var e=t.length,n=[],r=[],o=[],l=0;l<e;l++)n[l]=[],r[l]=[],o[l]=[];for(var i=!0,f=0;f<e;f++)for(l=0;l<e;l++)if(t[l][f]!==t[f][l]){i=!1;break}if(i){for(l=0;l<e;l++)n[l]=t[l].slice();!function(t,e,n){for(var r=n.length,o=0;o<r;o++)t[o]=n[r-1][o];for(var l=r-1;l>0;l--){for(var i=0,f=0,s=0;s<l;s++)i+=Math.abs(t[s]);if(0===i){e[l]=t[l-1];for(o=0;o<l;o++)t[o]=n[l-1][o],n[l][o]=0,n[o][l]=0}else{for(s=0;s<l;s++)t[s]/=i,f+=t[s]*t[s];var a=t[l-1],c=Math.sqrt(f);a>0&&(c=-c),e[l]=i*c,f-=a*c,t[l-1]=a-c;for(o=0;o<l;o++)e[o]=0;for(o=0;o<l;o++){a=t[o],n[o][l]=a,c=e[o]+n[o][o]*a;for(s=o+1;s<=l-1;s++)c+=n[s][o]*t[s],e[s]+=n[s][o]*a;e[o]=c}a=0;for(o=0;o<l;o++)e[o]/=f,a+=e[o]*t[o];var u=a/(f+f);for(o=0;o<l;o++)e[o]-=u*t[o];for(o=0;o<l;o++){a=t[o],c=e[o];for(s=o;s<=l-1;s++)n[s][o]-=a*e[s]+c*t[s];t[o]=n[l-1][o],n[l][o]=0}}t[l]=f}for(l=0;l<r-1;l++){if(n[r-1][l]=n[l][l],n[l][l]=1,0!=(f=t[l+1])){for(s=0;s<=l;s++)t[s]=n[s][l+1]/f;for(o=0;o<=l;o++){for(c=0,s=0;s<=l;s++)c+=n[s][l+1]*n[s][o];for(s=0;s<=l;s++)n[s][o]-=c*t[s]}}for(s=0;s<=l;s++)n[s][l+1]=0}for(o=0;o<r;o++)t[o]=n[r-1][o],n[r-1][o]=0;n[r-1][r-1]=1,e[0]=0}(r,o,n),function(t,e,n){for(var r=n.length,o=1;o<r;o++)e[o-1]=e[o];e[r-1]=0;for(var l=0,i=0,f=1e-12,a=0;a<r;a++){i=Math.max(i,Math.abs(t[a])+Math.abs(e[a]));for(var c=a;c<r&&!(Math.abs(e[c])<=f*i);)c++;if(c>a)do{var u=t[a],h=s(y=(t[a+1]-u)/(2*e[a]),1);y<0&&(h=-h),t[a]=e[a]/(y+h),t[a+1]=e[a]*(y+h);var g=t[a+1],d=u-t[a];for(o=a+2;o<r;o++)t[o]-=d;l+=d,y=t[c];var p=1,m=p,M=p,v=e[a+1],b=0,x=0;for(o=c-1;o>=a;o--){M=m,m=p,x=b,u=p*e[o],d=p*y,h=s(y,e[o]),e[o+1]=b*h,b=e[o]/h,y=(p=y/h)*t[o]-b*u,t[o+1]=d+b*(p*u+b*t[o]);for(var _=0;_<r;_++)d=n[_][o+1],n[_][o+1]=b*n[_][o]+p*d,n[_][o]=p*n[_][o]-b*d}y=-b*x*M*v*e[a]/g,e[a]=b*y,t[a]=p*y}while(Math.abs(e[a])>f*i);t[a]=t[a]+l,e[a]=0}for(o=0;o<r-1;o++){_=o;for(var y=t[o],w=o+1;w<r;w++)t[w]<y&&(_=w,y=t[w]);if(_!=o){t[_]=t[o],t[o]=y;for(w=0;w<r;w++)y=n[w][o],n[w][o]=n[w][_],n[w][_]=y}}}(r,o,n)}else{var a=[];for(l=0;l<e;l++)a[l]=t[l].slice();!function(t,e){for(var n=t.length,r=[],o=0,l=n-1,i=o+1;i<l;i++){for(var f=0,s=i;s<=l;s++)f+=Math.abs(t[s][i-1]);if(0!==f){var a=0;for(s=l;s>=i;s--)r[s]=t[s][i-1]/f,a+=r[s]*r[s];var c=Math.sqrt(a);r[i]>0&&(c=-c),a-=r[i]*c,r[i]=r[i]-c;for(var u=i;u<n;u++){var h=0;for(s=l;s>=i;s--)h+=r[s]*t[s][u];h/=a;for(s=i;s<=l;s++)t[s][u]-=h*r[s]}for(s=0;s<=l;s++){for(h=0,u=l;u>=i;u--)h+=r[u]*t[s][u];h/=a;for(u=i;u<=l;u++)t[s][u]-=h*r[u]}r[i]=f*r[i],t[i][i-1]=f*c}}for(s=0;s<n;s++)for(u=0;u<n;u++)e[s][u]=s===u?1:0;for(i=l-1;i>=o+1;i--)if(0!==t[i][i-1]){for(s=i+1;s<=l;s++)r[s]=t[s][i-1];for(u=i;u<=l;u++){for(c=0,s=i;s<=l;s++)c+=r[s]*e[s][u];c=c/r[i]/t[i][i-1];for(s=i;s<=l;s++)e[s][u]+=c*r[s]}}}(a,n),function(t,e,n,r){for(var o,l,i,f,s=n.length,a=s-1,u=0,h=s-1,g=1e-12,d=0,p=0,m=0,M=0,v=0,b=0,x=0,_=0;_<s;_++){(_<u||_>h)&&(t[_]=n[_][_],e[_]=0);for(var y=Math.max(_-1,0);y<s;y++)x+=Math.abs(n[_][y])}var w=0;for(;a>=u;){for(var k=a;k>u&&(0===(v=Math.abs(n[k-1][k-1])+Math.abs(n[k][k]))&&(v=x),!(Math.abs(n[k][k-1])<g*v));)k--;if(k===a)n[a][a]=n[a][a]+d,t[a]=n[a][a],e[a]=0,a--,w=0;else if(k===a-1){if(l=n[a][a-1]*n[a-1][a],m=(p=(n[a-1][a-1]-n[a][a])/2)*p+l,b=Math.sqrt(Math.abs(m)),n[a][a]=n[a][a]+d,n[a-1][a-1]=n[a-1][a-1]+d,i=n[a][a],m>=0){b=p+(p>=0?b:-b),t[a-1]=i+b,t[a]=t[a-1],0!==b&&(t[a]=i-l/b),e[a-1]=0,e[a]=0,p=(i=n[a][a-1])/(v=Math.abs(i)+Math.abs(b)),m=b/v,p/=M=Math.sqrt(p*p+m*m),m/=M;for(y=a-1;y<s;y++)b=n[a-1][y],n[a-1][y]=m*b+p*n[a][y],n[a][y]=m*n[a][y]-p*b;for(_=0;_<=a;_++)b=n[_][a-1],n[_][a-1]=m*b+p*n[_][a],n[_][a]=m*n[_][a]-p*b;for(_=u;_<=h;_++)b=r[_][a-1],r[_][a-1]=m*b+p*r[_][a],r[_][a]=m*r[_][a]-p*b}else t[a-1]=i+p,t[a]=i+p,e[a-1]=b,e[a]=-b;a-=2,w=0}else{if(i=n[a][a],f=0,l=0,k<a&&(f=n[a-1][a-1],l=n[a][a-1]*n[a-1][a]),10==w){d+=i;for(_=u;_<=a;_++)n[_][_]-=i;i=f=.75*(v=Math.abs(n[a][a-1])+Math.abs(n[a-1][a-2])),l=-.4375*v*v}if(30==w&&(v=(v=(f-i)/2)*v+l)>0){v=Math.sqrt(v),f<i&&(v=-v),v=i-l/((f-i)/2+v);for(_=u;_<=a;_++)n[_][_]-=v;d+=v,i=f=l=.964}w++;for(var A=a-2;A>=k&&(p=((M=i-(b=n[A][A]))*(v=f-b)-l)/n[A+1][A]+n[A][A+1],m=n[A+1][A+1]-b-M-v,M=n[A+2][A+1],p/=v=Math.abs(p)+Math.abs(m)+Math.abs(M),m/=v,M/=v,A!=k)&&!(Math.abs(n[A][A-1])*(Math.abs(m)+Math.abs(M))<g*(Math.abs(p)*(Math.abs(n[A-1][A-1])+Math.abs(b)+Math.abs(n[A+1][A+1]))));)A--;for(_=A+2;_<=a;_++)n[_][_-2]=0,_>A+2&&(n[_][_-3]=0);for(var $=A;$<=a-1;$++){var q=$!=a-1;if($!=A&&(p=n[$][$-1],m=n[$+1][$-1],M=q?n[$+2][$-1]:0,0!=(i=Math.abs(p)+Math.abs(m)+Math.abs(M))&&(p/=i,m/=i,M/=i)),0==i)break;if(v=Math.sqrt(p*p+m*m+M*M),p<0&&(v=-v),0!=v){$!=A?n[$][$-1]=-v*i:k!=A&&(n[$][$-1]=-n[$][$-1]),i=(p+=v)/v,f=m/v,b=M/v,m/=p,M/=p;for(y=$;y<s;y++)p=n[$][y]+m*n[$+1][y],q&&(p+=M*n[$+2][y],n[$+2][y]=n[$+2][y]-p*b),n[$][y]=n[$][y]-p*i,n[$+1][y]=n[$+1][y]-p*f;for(_=0;_<=Math.min(a,$+3);_++)p=i*n[_][$]+f*n[_][$+1],q&&(p+=b*n[_][$+2],n[_][$+2]=n[_][$+2]-p*M),n[_][$]=n[_][$]-p,n[_][$+1]=n[_][$+1]-p*m;for(_=u;_<=h;_++)p=i*r[_][$]+f*r[_][$+1],q&&(p+=b*r[_][$+2],r[_][$+2]=r[_][$+2]-p*M),r[_][$]=r[_][$]-p,r[_][$+1]=r[_][$+1]-p*m}}}}if(0==x)return;for(a=s-1;a>=0;a--)if(p=t[a],0==(m=e[a])){k=a;n[a][a]=1;for(_=a-1;_>=0;_--){l=n[_][_]-p,M=0;for(y=k;y<=a;y++)M+=n[_][y]*n[y][a];if(e[_]<0)b=l,v=M;else if(k=_,0===e[_]?n[_][a]=-M/(0!==l?l:g*x):(i=n[_][_+1],f=n[_+1][_],o=(i*v-b*M)/(m=(t[_]-p)*(t[_]-p)+e[_]*e[_]),n[_][a]=o,Math.abs(i)>Math.abs(b)?n[_+1][a]=(-M-l*o)/i:n[_+1][a]=(-v-f*o)/b),g*(o=Math.abs(n[_][a]))*o>1)for(y=_;y<=a;y++)n[y][a]=n[y][a]/o}}else if(m<0){k=a-1;if(Math.abs(n[a][a-1])>Math.abs(n[a-1][a]))n[a-1][a-1]=m/n[a][a-1],n[a-1][a]=-(n[a][a]-p)/n[a][a-1];else{var N=c(0,-n[a-1][a],n[a-1][a-1]-p,m);n[a-1][a-1]=N[0],n[a-1][a]=N[1]}n[a][a-1]=0,n[a][a]=1;for(_=a-2;_>=0;_--){var z,E,j=0,I=0;for(y=k;y<=a;y++)j+=n[_][y]*n[y][a-1],I+=n[_][y]*n[y][a];if(l=n[_][_]-p,e[_]<0)b=l,M=j,v=I;else{if(k=_,0==e[_]){N=c(-j,-I,l,m);n[_][a-1]=N[0],n[_][a]=N[1]}else{i=n[_][_+1],f=n[_+1][_],0==(z=(t[_]-p)*(t[_]-p)+e[_]*e[_]-m*m)&0==(E=2*(t[_]-p)*m)&&(z=g*x*(Math.abs(l)+Math.abs(m)+Math.abs(i)+Math.abs(f)+Math.abs(b)));N=c(i*M-b*j+m*I,i*v-b*I-m*j,z,E);if(n[_][a-1]=N[0],n[_][a]=N[1],Math.abs(i)>Math.abs(b)+Math.abs(m))n[_+1][a-1]=(-j-l*n[_][a-1]+m*n[_][a])/i,n[_+1][a]=(-I-l*n[_][a]-m*n[_][a-1])/i;else{N=c(-M-f*n[_][a-1],-v-f*n[_][a],b,m);n[_+1][a-1]=N[0],n[_+1][a]=N[1]}}if(g*(o=Math.max(Math.abs(n[_][a-1]),Math.abs(n[_][a])))*o>1)for(y=_;y<=a;y++)n[y][a-1]=n[y][a-1]/o,n[y][a]=n[y][a]/o}}}for(_=0;_<s;_++)if(_<u||_>h)for(y=_;y<s;y++)r[_][y]=n[_][y];for(y=s-1;y>=u;y--)for(_=u;_<=h;_++){b=0;for($=u;$<=Math.min(y,h);$++)b+=r[_][$]*n[$][y];r[_][y]=b}}(r,o,a,n)}var u=[];for(l=0;l<e;l++){var h=u[l]=[];for(f=0;f<e;f++)h[f]=l===f?r[l]:0;u[l][o[l]>0?l+1:l-1]=o[l]}return{D:u,V:n}}},determinant:function(t){var e=t[0].concat(t[1]).concat(t[2]).concat(t[3]);return e[12]*e[9]*e[6]*e[3]-e[8]*e[13]*e[6]*e[3]-e[12]*e[5]*e[10]*e[3]+e[4]*e[13]*e[10]*e[3]+e[8]*e[5]*e[14]*e[3]-e[4]*e[9]*e[14]*e[3]-e[12]*e[9]*e[2]*e[7]+e[8]*e[13]*e[2]*e[7]+e[12]*e[1]*e[10]*e[7]-e[0]*e[13]*e[10]*e[7]-e[8]*e[1]*e[14]*e[7]+e[0]*e[9]*e[14]*e[7]+e[12]*e[5]*e[2]*e[11]-e[4]*e[13]*e[2]*e[11]-e[12]*e[1]*e[6]*e[11]+e[0]*e[13]*e[6]*e[11]+e[4]*e[1]*e[14]*e[11]-e[0]*e[5]*e[14]*e[11]-e[8]*e[5]*e[2]*e[15]+e[4]*e[9]*e[2]*e[15]+e[8]*e[1]*e[6]*e[15]-e[0]*e[9]*e[6]*e[15]-e[4]*e[1]*e[10]*e[15]+e[0]*e[5]*e[10]*e[15]},dot:u,gaussjordan:h,inverse:function(t){var e=t.length,n=-1;if(e===t[0].length){for(t=t.map((function(t,n){for(var r=new Array(e),o=-1;++o<e;)r[o]=n===o?1:0;return t.concat(r)})),h(t);++n<e;)t[n]=t[n].slice(e);return t}},length:g,multiply:function(t,e){var n,r,o=t.length,l=e[0].length,i=e.length,f=-1;if(i!==t[0].length)throw{error:"columns(a) != rows(b); "+t[0].length+" != "+i};for(var s=new Array(o);++f<o;)for(s[f]=new Array(l),n=-1;++n<l;){var a=0;for(r=-1;++r<i;)a+=t[f][r]*e[r][n];s[f][n]=a}return s},normalize:function(t){var e=g(t);return t.map((function(t){return t/e}))},transpose:function(t){for(var e,n=t.length,r=t[0].length,o=-1,l=new Array(r);++o<r;)for(l[o]=new Array(n),e=-1;++e<n;)l[o][e]=t[e][o];return l},tridag:function(t,e,n,r,o,l){var i,f;for(i=1;i<l;i++)f=t[i]/e[i-1],e[i]-=f*n[i-1],r[i]-=f*r[i-1];for(o[l-1]=r[l-1]/e[l-1],i=l-2;i>=0;i--)o[i]=(r[i]-n[i]*o[i+1])/e[i]}});function p(t){var e=t<0?-1:1;t<0&&(e=-1,t=-t);var n=1/(1+.3275911*t);return e*(1-((((1.061405429*n-1.453152027)*n+1.421413741)*n-.284496736)*n+.254829592)*n*Math.exp(-t*t))}var m=1/Math.sqrt(2*Math.PI),M=Object.freeze({gaussian:function(){var t=Math.random,e=0,n=1,r=1;function o(){var r,o,l;do{l=(r=2*t()-1)*r+(o=2*t()-1)*o}while(l>=1||0===l);return e+n*r*Math.sqrt(-2*Math.log(l)/l)}return o.pdf=function(t){return t=(t-e)/n,m*Math.exp(-.5*t*t)/n},o.cdf=function(t){return.5*(1+p((t=(t-e)/n)/Math.SQRT2))},o.mean=function(t){return arguments.length?(e=+t,o):e},o.variance=function(t){return arguments.length?(n=Math.sqrt(r=+t),o):r},o.random=function(e){return arguments.length?(t=e,o):t},o}});function v(t){var e=t.length;if(0===e)return NaN;for(var n=0,r=-1;++r<e;)n+=(t[r]-n)/(r+1);return n}function b(t){var e=t.length;if(e<1)return NaN;if(1===e)return 0;for(var n=v(t),r=-1,o=0;++r<e;){var l=t[r]-n;o+=l*l}return o/(e-1)}function x(t,e){var n=(t=t.slice().sort(i)).length-1;return e.map((function(e){if(0===e)return t[0];if(1===e)return t[n];var r=1+e*n,o=Math.floor(r),l=r-o,i=t[o-1];return 0===l?i:i+l*(t[o]-i)}))}function _(t){var e=x(t,[.25,.75]);return e[1]-e[0]}function y(t){var e=_(t)/1.34;return 1.06*Math.min(Math.sqrt(b(t)),e)*Math.pow(t.length,-.2)}var w=Object.freeze({nrd0:function(t){var e,n=Math.sqrt(b(t));return(e=Math.min(n,_(t)/1.34))||(e=n)||(e=Math.abs(t[1]))||(e=1),.9*e*Math.pow(t.length,-.2)},nrd:y});function k(t,e){for(var n,r=t.length,o=-1,l=0;++o<r;)l+=(n=t[o]-e[o])*n;return Math.sqrt(l)}function A(t,e,n,r){for(var o=[],l=t+n,i=e.length,f=-1;++f<i;)o[f]=(t*e[f]+n*r[f])/l;return o}function $(t){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*t*t)}function q(t,e){if(!t||!e||t.length!==e.length)return!1;for(var n=t.length,r=-1;++r<n;)if(t[r]!==e[r])return!1;return!0}function N(t){return x(t,[.5])[0]}function z(t){for(var e=t.length,n=-1;++n<e;)if(!isFinite(t[n]))return!1;return!0}function E(t){for(var e=t.length,n=0;++n<e;)if(t[n-1]>=t[n])return!1;return!0}function j(t){return(t=1-t*t*t)*t*t}function I(t,e,n,r){var o=r[0],l=D(e,r[1]);if(l<t.length&&t[l]-t[n]<t[n]-t[o]){var i=D(e,o);r[0]=i,r[1]=l}}function D(t,e){for(var n=e+1;n<t.length&&0===t[n];)n++;return n}var O=Object.freeze({euclidean:k,manhattan:function(t,e){for(var n=t.length,r=-1,o=0;++r<n;)o+=Math.abs(t[r]-e[r]);return o},minkowski:function(t){return function(e,n){for(var r=e.length,o=-1,l=0;++o<r;)l+=Math.pow(Math.abs(e[o]-n[o]),t);return Math.pow(l,1/t)}},chebyshev:function(t,e){for(var n,r=t.length,o=-1,l=0;++o<r;)(n=Math.abs(t[o]-e[o]))>l&&(l=n);return l},hamming:function(t,e){for(var n=t.length,r=-1,o=0;++r<n;)t[r]!==e[r]&&o++;return o},jaccard:function(t,e){for(var n=t.length,r=-1,o=0;++r<n;)t[r]===e[r]&&o++;return o/n},braycurtis:function(t,e){for(var n,r,o=t.length,l=-1,i=0,f=0;++l<o;)n=t[l],r=e[l],i+=Math.abs(n-r),f+=Math.abs(n+r);return i/f}}),P=Object.freeze({uniform:function(t){return t<=1&&t>=-1?.5:0},triangular:function(t){return t<=1&&t>=-1?1-Math.abs(t):0},epanechnikov:function(t){return t<=1&&t>=-1?.75*(1-t*t):0},quartic:function(t){if(t<=1&&t>=-1){var e=1-t*t;return 15/16*e*e}return 0},triweight:function(t){if(t<=1&&t>=-1){var e=1-t*t;return 35/32*e*e*e}return 0},gaussian:$,cosine:function(t){return t<=1&&t>=-1?Math.PI/4*Math.cos(Math.PI/2*t):0}}),T=M,F=w,R=Object.freeze({distance:O,kernel:P,distribution:T,bandwidth:F,erf:p,hcluster:function(){var t=k;function e(e){var n,r,o,l,i,f,s,a,c=e.length,u=[],h=[],g=[],d=[];for(s=-1;++s<c;)for(u[s]=0,g[s]=[],a=-1;++a<c;)g[s][a]=s===a?1/0:t(e[s],e[a]),g[s][u[s]]>g[s][a]&&(u[s]=a);for(s=-1;++s<c;)d[s]=[],d[s][0]={left:null,right:null,dist:0,centroid:e[s],size:1,depth:0},h[s]=1;for(i=0;i<c-1;i++){for(n=0,s=0;s<c;s++)g[s][u[s]]<g[n][u[n]]&&(n=s);r=u[n];var p={left:o=d[n][0],right:l=d[r][0],dist:g[n][r],centroid:A(o.size,o.centroid,l.size,l.centroid),size:o.size+l.size,depth:1+Math.max(o.depth,l.depth)};for(d[n].splice(0,0,p),h[n]+=h[r],a=0;a<c;a++)g[n][a]>g[r][a]&&(g[a][n]=g[n][a]=g[r][a]);for(g[n][n]=1/0,s=0;s<c;s++)g[s][r]=g[r][s]=1/0;for(a=0;a<c;a++)u[a]==r&&(u[a]=n),g[n][a]<g[n][u[n]]&&(u[n]=a);f=p}return f}return e.distance=function(n){return arguments.length?(t=n,e):t},e},iqr:_,kde:function(){var t=$,e=[],n=y;function r(r,o){var l=n.call(this,e);return r.map((function(n){for(var r=-1,o=0,i=e.length;++r<i;)o+=t((n-e[r])/l);return[n,o/l/i]}))}return r.kernel=function(e){return arguments.length?(t=e,r):t},r.sample=function(t){return arguments.length?(e=t,r):e},r.bandwidth=function(t){return arguments.length?(n=f(t),r):n},r},kmeans:function(){var t=k,e=1;function n(n){for(var r,o,l,i,f,s,a,c=n.length,u=[],h=[],g=1,d=0,p=function(t,e){var n=e.length;if(t>n)return null;var r,o,l,i=[],f=[],s={},a=0,c=0;for(;c<t;){if(a===n)return null;var u=Math.floor(Math.random()*n);if(!(u in s)){for(s[u]=1,a++,o=e[u],l=!0,r=0;r<c;r++)if(q(o,i[r])){l=!1;break}l&&(i[c]=o,f[c]=u,c++)}}return i}(e,n);g&&d<1e3;){for(l=-1;++l<e;)h[l]=0;for(o=-1;++o<c;){for(i=n[o],s=1/0,l=-1;++l<e;)(f=t.call(this,p[l],i))<s&&(s=f,a=l);h[u[o]=a]++}for(r=[],o=-1;++o<c;)if(null==(f=r[i=u[o]]))r[i]=n[o].slice();else for(l=-1;++l<f.length;)f[l]+=n[o][l];for(l=-1;++l<e;)for(i=r[l],f=1/h[l],o=-1;++o<i.length;)i[o]*=f;for(g=0,l=-1;++l<e;)if(!q(r[l],p[l])){g=1;break}p=r,d++}return{assignments:u,centroids:p}}return n.k=function(t){return arguments.length?(e=t,n):e},n.distance=function(e){return arguments.length?(t=e,n):t},n},loess:function(){var t=.3,e=2,n=1e-12;function r(r,o,l){var i,f=r.length;if(f!==o.length)throw{error:"Mismatched array lengths"};if(0==f)throw{error:"At least one point required."};if(arguments.length<3)for(l=[],i=-1;++i<f;)l[i]=1;if(z(r),z(o),z(l),E(r),1==f)return[o[0]];if(2==f)return[o[0],o[1]];var s=Math.floor(t*f);if(s<2)throw{error:"Bandwidth too small."};var a=[],c=[],u=[];for(i=-1;++i<f;)a[i]=0,c[i]=0,u[i]=1;for(var h=-1;++h<=e;){var g,d=[0,s-1];for(i=-1;++i<f;){g=r[i],i>0&&I(r,l,i,d);for(var p=d[0],m=d[1],M=r[i]-r[p]>r[m]-r[i]?p:m,v=0,b=0,x=0,_=0,y=0,w=Math.abs(1/(r[M]-g)),k=p;k<=m;++k){var A=r[k],$=o[k],q=k<i?g-A:A-g,D=A*(B=j(q*w)*u[k]*l[k]);v+=B,b+=D,x+=A*D,_+=$*B,y+=$*D}var O=b/v,P=_/v,T=y/v,F=x/v,R=Math.sqrt(Math.abs(F-O*O))<n?0:(T-O*P)/(F-O*O),S=P-R*O;a[i]=R*g+S,c[i]=Math.abs(o[i]-a[i])}if(h===e)break;var V,B,L=N(c);if(Math.abs(L)<n)break;for(i=-1;++i<f;)V=c[i]/(6*L),u[i]=V>=1?0:(B=1-V*V)*B}return a}return r.bandwidth=function(e){return arguments.length?(t=e,r):e},r.robustnessIterations=function(t){return arguments.length?(e=t,r):t},r.accuracy=function(t){return arguments.length?(n=t,r):t},r},mean:v,median:N,mode:function(t){for(var e,n,r={},o=[],l=0,i=t.length,f=-1;++f<i;)(n=r.hasOwnProperty(e=t[f])?++r[e]:r[e]=1)===l?o.push(e):n>l&&(l=n,o=[e]);if(1===o.length)return o[0]},phi:function(t){return.5*(1+p(t/Math.SQRT2))},quantiles:x,variance:b}),S=d,V=R;const{dot:B,length:L,normalize:Q,transpose:U}=S,{mean:X}=V;function G(t,e){return t-e}const Y=G;function C(t,e){return t.concat(e)}function H(t){let e=-1;const n=[];if(1===arguments.length)for(;++e<t;)n[e]=1/0;else for(;++e<t;)n[e]=H.apply(this,Array.prototype.slice.call(arguments,1));return n}function J(t,e){let n=-1;const r=Array(t);for(;++n<t;)r[n]=e;return r}function K(t,e){const n=[];e||(e=t.components());for(let r=0;r<e.length;r++)n.push(W(t,e[r]));return n}function W(t,e){const n=H(e.length,e.length),o=r(e);for(let t=0;t<e.length;t++)n[t][t]=0;const l=e=>{if(e.source==e.target)return;if(!(e.source.index in o)||!(e.target.index in o))return;const r=o[e.source.index],l=o[e.target.index];n[l][r]=n[r][l]=t.distance(e.index)};for(let n=0;n<e.length;n++)t.edges(e[n]).forEach(l);for(let t=0;t<e.length;t++)for(let r=0;r<e.length;r++)if(n[r][t]!=1/0)for(let o=0;o<e.length;o++)n[t][o]!=1/0&&n[r][o]>n[r][t]+n[t][o]&&(n[r][o]=n[r][t]+n[t][o],n[o][r]=n[r][o]);return n}function Z(t,e,o){const l=n(t.nodes().length);void 0===e&&(e=l.filter((e=>0!==t.outDegree(e))),o=l.filter((e=>0!==t.inDegree(e))));let i=!1;if(e.length<o.length){const t=e;e=o,o=t,i=!0}const f=r(o);let s=[];for(let n=0;n<e.length;n++){const r=i?t.inEdges(e[n]).map((t=>f[t.target.index])):t.outEdges(e[n]).map((t=>f[t.source.index]));r.sort(Y),s=s.concat(r)}let c=1;for(;c<o.length;)c<<=1;const u=2*c-1;c-=1;const h=a(u);let g=0;for(let t=0;t<s.length;t++){let e=s[t]+c;for(h[e]++;e>0;)e%2&&(g+=h[e+1]),e=e-1>>1,h[e]++}return g}function tt(t){if(0===t.length)return-1;if(1===t.length)return t[0];if(2===t.length)return(t[0]+t[1])/2;if(t.sort(Y),t.length%2)return t[(t.length-1)/2];const e=t.length/2,n=e-1,r=t[t.length-1]-t[e],o=t[n]-t[0];return o==r?(t[n]+t[e])/2:(t[n]*r+t[e]*o)/(o+r)}function et(e,n,o){const l=e.nodes();let i,f,s,a,c,u=n.filter((t=>0!==e.outDegree(t))),h=n.filter((t=>0!==e.inDegree(t)));if(e.directed()||(u=h),n.length<3)return[u,h,Z(e,u,h)];o?o%2==1&&o++:o=24;let g,d=r(h),p=Z(e,u,h),m=u.slice(),M=h.slice(),v=0;const b=t=>d[t.source==g?t.target.index:t.source.index],x=(t,n)=>{let r=c[t]-c[n];return 0===r&&(r=e.edges(n).length%2-e.edges(t).length%2),r<0?-1:r>0?1:0};for(s=u,f=0;f<o;f++,s=s==u?h:u){c={};for(let t=0;t<s.length;t++)g=l[s[t]],a=s==u?e.outEdges(g.index):e.inEdges(g.index),a=a.map(b),c[g.index]=+tt(a);s.sort(x);for(let t=0;t<s.length;t++)d=r(s);i=Z(e,u,h),i<p&&(p=i,m=u.slice(),M=h.slice(),v=f,o=Math.max(o,f+2))}return t.debug&&console.log(`Best iter: ${v}`),[m,M,p]}t.debug=!1;class nt{constructor(){this.length=0}push(t){const e={item:t};this.last?this.last=this.last.next=e:this.last=this.first=e,this.length++}shift(){const t=this.first;if(t)return this.first=t.next,--this.length||(this.last=void 0),t.item}slice(t=0,e=1/0){const n=[];let r=0;for(let o=this.first;o&&!(--e<0);o=o.next)++r>t&&n.push(o.item);return n}}function rt(t,e,n){const r=new nt,o={};for(r.push(e),o[e]=!0,n(e,void 0);r.length;){n(e=r.shift(),e);const l=t.edges(e);for(let i=0;i<l.length;i++){const f=l[i],s=t.other(f,e).index;o[s]||(r.push(s),o[s]=!0,n(e,s))}n(e,-1)}}function ot(t,e){const n={};return n[e]=0,rt(t,e,((t,e)=>{e>=0&&t!=e&&(n[e]=n[t]+1)})),n}function lt(t){return n(0,t.length).sort(((e,n)=>t[e]-t[n]))}const it=lt;function ft(e){const n=e.length,r=e[0].length,o=function(t){const e=t.length,n=t[0].length,r=a(n);for(let o=0;o<e;o++){const e=t[o];for(let t=0;t<n;t++)r[t]+=e[t]}return r}(e),l=function(t){const e=t.length,n=t[0].length,r=Array(e);for(let o=0;o<e;o++){const e=t[o];let l=0;for(let t=0;t<n;t++)l+=e[t];r[o]=l}return r}(e),i=function(e,n,r,o,l,i,f){let s,c,u,h,g,d,p,m,M,v,b,x,_,y,w,k,A,$,q,N;const z=a(o),E=a(o),j=a(o),I=a(o);let D=0;for(let t=0;t<o;t++)D+=f[t],n[t]=t+1;n[0]=1.1;let O=5e-6;for(st(n,n,e,i,r,o,l),s=0;;){c=0;for(let t=0;t<o;t++)c+=n[t]*f[t];c/=D,h=0;for(let t=0;t<o;t++)u=n[t]-c,h+=u*u*f[t],n[t]=u;h=Math.sqrt(h);for(let t=0;t<o;t++)n[t]/=h;st(n,z,e,i,r,o,l),c=0,g=0,d=0,p=0,m=0,M=0,v=0,b=0;for(let t=0;t<o;t++)u=z[t],z[t]=u/f[t],c+=u,g+=u*n[t];c/=D;for(let t=0;t<o;t++)u=z[t]-(c+g*n[t]),d+=u*u*f[t],z[t]=u;d=Math.sqrt(d);for(let t=0;t<o;t++)z[t]/=d;if(d<O||s>999)break;s++,st(z,E,e,i,r,o,l),c=0,A=0;for(let t=0;t<o;t++)u=E[t],E[t]=u/f[t],c+=u,p+=u*z[t],A+=u*n[t];c/=D;for(let t=0;t<o;t++)u=E[t]-(c+p*z[t]+A*n[t]),m+=u*u*f[t],E[t]=u;if(m=Math.sqrt(m),m>O){for(let t=0;t<o;t++)E[t]/=m;st(E,j,e,i,r,o,l),c=0,$=0,q=0;for(let t=0;t<o;t++)u=j[t],j[t]/=f[t],c+=u,M+=u*E[t],$+=u*n[t],q+=u*z[t];c/=D;for(let t=0;t<o;t++)u=j[t]-(c+M*E[t]+$*n[t]+q*z[t]),v+=u*u*f[t],j[t]=u;if(v=Math.sqrt(v),v>O){for(let t=0;t<o;t++)j[t]/=v;st(j,I,e,i,r,o,l);for(let t=0;t<o;t++)b+=j[t]*I[t]}else v=0}else m=0;if(x=ht(O,g,d,p,m,M,v,b),_=x[0],y=x[1],w=x[2],k=x[3],d<O)break;for(let t=0;t<o;t++)n[t]=_*n[t]+y*z[t]+w*E[t]+k*j[t]}d>O&&t.debug>0&&console.log("residual bigger than tolerance on axis 1");let P=n[0],T=n[0];for(let t=1;t<o;t++)c=n[t],c<T?T=c:c>P&&(P=c);if(-T>P)for(let t=0;t<o;t++)n[t]=-n[t];ct(n,e,r,o,l);for(let t=0;t<r;t++)e[t]/=i[t];let F=0;for(let t=0;t<r;t++)F+=i[t]*ut(e[t]);F=Math.sqrt(F);for(let t=0;t<r;t++)e[t]/=F;for(let t=0;t<o;t++)n[t]/=F;let R,S=0;for(let t=0;t<r;t++){R=e[t],N=l[t];for(let t=0;t<o;t++)S+=N[t]*ut(R-n[t])}let V=Math.sqrt(S/D);if(g>=.999){V=P/F;const t=-T/F;t>V&&(V=t)}for(let t=0;t<o;t++)n[t]/=V;return{rows:e,cols:n,eig:g}}(J(n,1),J(r,1),n,r,e,l,o);if(i.eig<1e-7)i.rows=i.cols=[],i.eig=0;else{const t=i.rows;ct(i.cols,t,n,r,e);for(let e=0;e<n;e++)t[e]/=l[e]}return i}function st(t,e,n,r,o,l,i,f){f&&console.log(`TRANS ${f}`),ct(t,n,o,l,i,f);for(let t=0;t<o;t++)n[t]=n[t]/r[t];!function(t,e,n,r,o,l){l&&(console.log("xymult"),at(e));for(let t=0;t<r;t++)e[t]=0;for(let l=0;l<n;l++){const n=t[l],i=o[l];for(let t=0;t<r;t++)e[t]+=n*i[t]}l&&at(e)}(n,e,o,l,i,f)}function at(t){console.log("");for(let e=0;e<t.length;e++)console.log(`i:${e+1} v:  ${t[e].toFixed(5)}`)}function ct(t,e,n,r,o,l){l&&(console.log("yxmult"),at(e));for(let l=0;l<n;l++){let n=0;const i=o[l];for(let e=0;e<r;e++)n+=t[e]*i[e];e[l]=n}l&&at(e)}function ut(t){return t*t}function ht(t,e,n,r,o,l,i,f){let s,a,c,u,h,g,d,p=1,m=.1,M=.01,v=.001;for(let b=0;b<100&&(s=e*p+n*m,a=n*p+r*m+o*M,c=o*m+l*M+i*v,u=i*M+f*v,p=e*s+n*a,m=n*s+r*a+o*c,M=o*a+l*c+i*u,v=i*c+f*u,h=Math.sqrt(ut(p)+ut(m)+ut(M)+ut(v)),p/=h,m/=h,M/=h,v/=h,(b+1)%5==0&&(g=Math.sqrt(h),d=Math.sqrt(ut(p-s/g)+ut(m-a/g)+ut(M-c/g)+ut(v-u/g))),!(d<.05*t));b++);return[p,m,M,v]}const gt=ft,dt=ft;const pt={pearson(t,e){const n=X(t),r=X(e),o=Math.min(t.length,e.length);if(0===o)return NaN;let l=0,i=0,f=0;for(let s=0;s<o;s++){const o=t[s]-n,a=e[s]-r;l+=o*a,i+=o*o,f+=a*a}return l/Math.sqrt(i*f)},pearsonMatrix(t){const e=pt.pearson,n=t.length;if(0===n)return NaN;const r=a(n,n);for(let o=0;o<n-1;o++)for(let l=o+1;l<n;l++){const n=e(t[o],t[l]);r[o][l]=r[l][o]=n}return r}},mt=B;function Mt(t,e,n){const r=t.length;let o=0;for(let l=0;l<r;l++)o+=t[l][e]*t[l][n];return o}function vt(t){const e=t[0].length,n=Array(e);for(let t=0;t<e;t++)n[t]=Array(e);for(let r=0;r<e;r++)for(let o=r;o<e;o++)n[r][o]=n[o][r]=Mt(t,r,o);return n}function bt(t,e){if(e.length<3)return e;const n={},o=new nt,l=r(e),i=[];let f=e[0],s=t.degree(f);for(let n=0;n<e.length;n++){const r=e[n];if(t.degree(r)<s&&(s=t.degree(r),f=r,1==s))break}for(o.push(f);0!==o.length;){const e=o.shift();if(n[e])continue;n[e]=!0,i.push(e);t.edges(e).map((n=>t.other(n,e).index)).filter((t=>!n[t]&&t in l)).sort(((e,n)=>t.degree(e)-t.degree(n))).forEach(o.push,o)}return i}function xt(t,e){return bt(t,e).reverse()}function _t(t,e,n,r){r||(r="");for(let o=0;o<t.length;o++)0!==r.length&&(r+=", "),r+=n?t[n[o]].toFixed(e):t[o].toFixed(e);console.log(r)}function yt(t,e,n,r){e||(e=4);for(let o=0;o<t.length;o++){_t(n?t[n[o]]:t[o],e,r,`${o}: `)}}function wt(t,e){if(!t)throw console.log(e),e||"Assertion failed"}function kt(t,e){return null===t.left?`${Array(e+1).join(" ")}id: ${t.id}`:`${Array(e+1).join(" ")}id: ${t.id}, dist: ${t.dist}\n${kt(t.left,e+1)}\n${kt(t.right,e+1)}`}function At(t,e){return!(isNaN(t)||isNaN(e)||t==1/0||e==1/0)}const $t={};function qt(){let t=$t.euclidean;function e(e){const n=e.length,r=[];for(let o=0;o<n;o++){const l=[];r[o]=l;for(let i=0;i<n;i++)i<o?l.push(r[i][o]):o===i?l.push(0):l.push(t(e[o],e[i]))}return r}return e.distance=function(n){return arguments.length?(t=n,e):t},e}function Nt(t){let e=0;const n=t.length;for(let r=0;r<n;r++){const o=t[r];for(let t=r+1;t<n;t++)o[t]>e&&(e=o[t])}return e}function zt(t,e,n=e+1){t.splice(e,n-e);for(let r=t.length;r-- >0;)t[r].splice(e,n-e);return t}function Et(t,e=0,n=t.length){let r=n-e;for(;r>0;){const n=e+Math.floor(Math.random()*r--),o=t[e+r];t[e+r]=t[n],t[n]=o}return t}function jt(t,e,n){const r=Array(t);if(1==arguments.length)for(;t;)r[--t]=Math.random();else if(2==arguments.length)for(;t;)r[--t]=Math.random()*e;else for(;t;)r[--t]=e+Math.random()*(n-e);return r}function It(t){const e=L(t);let n=t.length;if(0===e||Math.abs(e-1)<1e-9)return 1;for(;n-- >0;)t[n]/=e;return e}function Dt(t,e,n){e||(e=1e-9);const r=t.length;let o,l=Array(r),i=100;for(wt(r==t[0].length,"poweriteration needs a square matrix"),o=n?n.slice():jt(r),It(o);i-- >0;){for(let e=0;e<r;e++){l[e]=0;for(let n=0;n<r;n++)l[e]+=t[e][n]*o[n]}if(It(l),B(l,o)>1-e)break;const n=l;l=o,o=n}return l}function Ot(e,n,r,o,l){o||(o=1e-9);const i=e.length,f=Array(n);let s=Array(i),a=100;const c=Array(n);if(wt(i==e[0].length,"poweriteration needs a square matrix"),r)for(let t=0;t<n;t++)f[t]=r[t].slice(),c[t]=It(f[t]);else for(let t=0;t<n;t++){const e=f[t]=jt(i);c[t]=It(e)}l||(l=0);for(let r=l;r<n;r++){let n=f[r];for(;a-- >0;){for(let t=0;t<r;t++){const e=f[t],r=B(n,e);for(let t=0;t<i;t++)n[t]-=r*e[t]}for(let t=0;t<i;t++){s[t]=0;for(let r=0;r<i;r++)s[t]+=e[t][r]*n[r]}if(c[r]=It(s),B(s,n)>1-o)break;n=s,s=f[r],f[r]=n}t.debug&&console.log("eig[%d]=%j",r,n)}return[f,c]}function Pt(e,n){const r=function(e){let n=0;const r=e.length;for(let t=0;t<r;t++){const o=e[t];let l=o[t];for(let e=0;e<r;e++)e!=t&&(l+=Math.abs(o[e]));l>n&&(n=l)}return t.debug&&console.log("gershgorin_bound=%d",n),n}(e),o=e.length,l=e.map((t=>t.slice()));for(let t=0;t<o;t++){const e=l[t];for(let n=0;n<o;n++)e[n]=t==n?r-e[n]:-e[n]}return Ot(l,2,[J(o,1),jt(o)],n,1)[0][1]}function Tt(e,n,r){const o={};let l,i,f,s,a=1;return o.nodes=function(t){return arguments.length?(e=t,o):e},o.nodes_indices=()=>e.map((t=>t.index)),o.generate_nodes=t=>{e=[];for(let n=0;n<t;n++)e.push({id:n});return o},o.links=function(t){return arguments.length?(n=t,o):n},o.links_indices=()=>n.map((t=>({source:t.source.index,target:t.target.index}))),o.linkDistance=function(t){return arguments.length?(a="function"==typeof t?t:+t,o):a},o.directed=function(t){return arguments.length?(r=t,o):r},o.init=function(){const t=e.length,c=n.length;s=void 0;for(let n=0;n<t;++n){const t=e[n];t.index=n,t.weight=0}for(let t=0;t<c;++t){const r=n[t];r.index=t,"number"==typeof r.source&&(r.source=e[r.source]),"number"==typeof r.target&&(r.target=e[r.target]),"value"in r||(r.value=1),r.source.weight++,r.target.weight++}if("function"==typeof a)for(let t=0;t<c;++t)n[t].distance=+a.call(this,n[t],t);else for(let t=0;t<c;++t)n[t].distance=a;l=Array(e.length);for(let t=0;t<e.length;++t)l[t]=[];if(r){i=Array(e.length),f=Array(e.length);for(let t=0;t<e.length;++t)i[t]=[],f[t]=[]}else i=f=l;for(let t=0;t<n.length;++t){const e=n[t];l[e.source.index].push(e),e.source.index!=e.target.index&&l[e.target.index].push(e),r&&i[e.source.index].push(e),r&&f[e.target.index].push(e)}return o},o.edges=e=>("number"!=typeof e&&(e=e.index,t.debug&&console.log("received node %d",e)),l[e]),o.degree=t=>("number"!=typeof t&&(t=t.index),l[t].length),o.inEdges=t=>("number"!=typeof t&&(t=t.index),i[t]),o.inDegree=t=>("number"!=typeof t&&(t=t.index),i[t].length),o.outEdges=t=>("number"!=typeof t&&(t=t.index),f[t]),o.outDegree=t=>("number"!=typeof t&&(t=t.index),f[t].length),o.sinks=()=>{const t=[];for(let n=0;n<e.length;n++)0===o.outEdges(n).length&&t.push(n);return t},o.sources=()=>{const t=[];for(let n=0;n<e.length;n++)0===o.inEdges(n).length&&t.push(n);return t},o.distance=function(t){return n[t].distance},o.neighbors=function(t){const e=l[t],n=[];for(const r of e)r.source.index==t?n.push(r.target):n.push(r.source);return n},o.other=(t,e)=>("number"==typeof t&&(t=n[t]),t.source.index===e?t.target:t.source),o.components=()=>(s||(s=function(){const t=[],n=[],r=e.length;for(let t=0;t<r;t++)e[t].comp=0;for(let o=0,i=0;o<r;o++){if(0!==e[o].comp)continue;i+=1,e[o].comp=i,t.push(o);const r=[o];for(;t.length;){const e=t.shift(),n=l[e];for(let o=0;o<n.length;o++){const l=n[o];let f=l.source;f.index==e&&(f=l.target),f.index!=e&&0===f.comp&&(f.comp=i,r.push(f.index),t.push(f.index))}}r.length&&(r.sort(Y),n.push(r))}return n.sort(((t,e)=>e.length-t.length)),n}()),s),o}function Ft(t,e){let n=e.length;const r=t.slice();for(;n--;)r[n]=t[e[n]];return r}function Rt(t){const e=t.length,n=a(e,e),r=Nt(t);for(let o=0;o<e;o++)for(let l=o;l<e;l++)n[l][o]=n[o][l]=1+r-t[o][l];return n}function St(t){const e=Array(t);for(let n=0;n<t;n++)e[n]={id:n};return e}function Vt(t,e){return Tt(St(t),[],e)}function Bt(t,e){const n=St(t),r=[];if(e)for(let e=0;e<t;e++)for(let n=0;n<t;n++)e!=n&&r.push({source:e,target:n});else for(let e=0;e<t-1;e++)for(let n=e+1;n<t;n++)r.push({source:e,target:n});return Tt(n,r,e).init()}function Lt(t,e,n){if(e<=0)return Vt(t,n);if(e>=1)return Bt(t,n);const r=St(t),o=[];let l=-1,i=Math.log(1-e);if(n)for(let e=0;e<t;){const n=Math.log(1-Math.random());for(l=l+1+Math.floor(n/i),e==l&&(l+=1);l>=t&&e<t;)l-=t,e+=1,e==l&&(l+=1);e<t&&o.push({source:e,target:l})}else for(let e=1;e<t;){const n=Math.log(1-Math.random());for(l=l+1+Math.floor(n/i);l>=e&&e<t;)l-=e,e+=1;e<t&&o.push({source:e,target:l})}return Tt(r,o,n).init()}$t.euclidean=function(t,e){let n=0;for(let r=t.length-1;r>=0;r--)if(At(t[r],e[r])){const o=t[r]-e[r];n+=o*o}return Math.sqrt(n)},$t.manhattan=function(t,e){let n=0;for(let r=t.length-1;r>=0;r--)At(t[r],e[r])&&(n+=Math.abs(t[r]-e[r]));return n},$t.minkowski=function(t){return(e,n)=>{let r=0;for(let o=e.length-1;o>=0;o--)At(e[o],n[o])&&(r+=Math.pow(Math.abs(e[o]-n[o]),t));return Math.pow(r,1/t)}},$t.chebyshev=function(t,e){let n=0;for(let r=t.length-1;r>=0;r--)if(At(t[r],e[r])){const o=Math.abs(t[r]-e[r]);o>n&&(n=o)}return n},$t.hamming=function(t,e){let n=0;for(let r=t.length-1;r>=0;r--)At(t[r],e[r])&&t[r]!==e[r]&&n++;return n},$t.jaccard=function(t,e){let n=0,r=0;for(let o=t.length-1;o>=0;o--)At(t[o],e[o])&&(t[o]===e[o]&&r++,n++);return 0===n?0:r/n},$t.braycurtis=function(t,e){let n=0,r=0;for(let o=t.length-1;o>=0;o--){const l=t[o],i=e[o];At(l,i)&&(n+=Math.abs(l-i),r+=Math.abs(l+i))}return 0===r?0:n/r},$t.morans=function(t){let e=0;const n=t.length*t[0].length;for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)e+=t[n][r];return(t,r)=>{let o=0;for(let l=0;l<t.length;l++)At(t[l],r[l])&&(o+=(t[l]*n-e)*(r[l]*n-e));return-1*o}};const Qt=Lt;function Ut(){let t=$t.euclidean,e="single",n=null;function r(r){const o=r.length,l=[],i=[],f=[];let s,a=0;if(null===n){n=[];let e=-1;for(;++e<o;){l[e]=0,n[e]=[];let i=-1;for(;++i<o;)n[e][i]=e===i?1/0:t(r[e],r[i]),n[e][l[e]]>n[e][i]&&(l[e]=i)}}else{if(n.length<o||n[0].length<o)throw{error:`Provided distance matrix length ${n.length} instead of ${o}`};let t=-1;for(;++t<o;){l[t]=0;let e=-1;for(;++e<o;)t===e&&(n[t][e]=1/0),n[t][l[t]]>n[t][e]&&(l[t]=e)}}let c=-1;for(;++c<o;)c!=a&&console.log("i = %d, id = %d",c,a),f[c]={left:null,right:null,dist:0,centroid:r[c],id:a++,size:1,depth:0},i[c]=1;for(let t=0;t<o-1;t++){let t=0;for(c=0;c<o;c++)n[c][l[c]]<n[t][l[t]]&&(t=c);const r=l[t],u=f[t],h=f[r],g={left:u,right:h,dist:n[t][r],centroid:Xt(u.size,u.centroid,h.size,h.centroid),id:a++,size:u.size+h.size,depth:1+Math.max(u.depth,h.depth)};f[t]=g;for(let l=0;l<o;l++)if(l!==t&&l!==r)switch(e){case"single":n[t][l]>n[r][l]&&(n[l][t]=n[t][l]=n[r][l]);break;case"complete":n[t][l]<n[r][l]&&(n[l][t]=n[t][l]=n[r][l]);break;case"average":n[l][t]=n[t][l]=(i[t]*n[t][l]+i[r]*n[r][l])/(i[t]+i[r])}i[t]+=i[r];for(let t=0;t<o;t++)n[t][r]=n[r][t]=1/0;for(let i=0;i<o;i++){if("single"===e)l[i]===r&&(l[i]=t);else if(l[i]===r||l[i]===t)for(let t=0;t<o;t++)n[i][t]<n[i][l[i]]&&(l[i]=t);n[t][i]<n[t][l[t]]&&(l[t]=i)}s=g}return s}return r.linkage=function(t){return arguments.length?(e=t,r):e},r.distance=function(e){return arguments.length?(t=e,r):t},r.distanceMatrix=function(t){return arguments.length?(n=t.map((t=>t.slice(0))),r):n},r}function Xt(t,e,n,r){const o=[],l=t+n,i=e.length;let f=-1;for(;++f<i;)o[f]=(t*e[f]+n*r[f])/l;return o}function Gt(t,e){const n=e.length,o=a(n,n),l=r(e);wt(!t.directed(),"Laplacian only for undirected graphs");for(let r=0;r<n;r++){const n=e[r],i=o[r];let f=0;const s=t.edges(n);for(let e=0;e<s.length;e++){const o=s[e],a=l[t.other(o,n).index];a!=r&&(f+=o.value,i[a]=-o.value)}i[r]=f}return o}function Yt(t){const e=t.length;if(0===e)return NaN;const n=t[0].length,r=t[0].slice(0);let o=0;for(;++o<e;){const e=t[o];for(let t=0;t<n;t++)r[t]+=(e[t]-r[t])/(o+1)}return r}function Ct(t,e,n,r){let l=0;for(let i=0;i<t.length;i++)l+=o(t[i],e,n,r);return l}function Ht(t,e,n,r){let o=0;for(let i=0;i<t.length;i++)o+=l(t[i],e,n,r);return o}function Jt(t){if(0===t.length)return 0;if(1===t.length)return t[0];if(2===t.length)return(t[0]+t[1])/2;if(t.sort(Y),t.length%2)return t[(t.length-1)/2];const e=t.length/2,n=e-1,r=t[t.length-1]-t[e],o=t[n]-t[0];return o==r?(t[n]+t[e])/2:(t[n]*r+t[e]*o)/(o+r)}function Kt(t,e,n){let r=0;for(let o=0;o<t.length;o++){r+=Z(t[o],e,n)}return r}function Wt(e,n,o){let l,i,f,s,a,c=e[0].nodes(),u=!1,h=n.filter((t=>{for(let n=0;n<e.length;n++)return 0!==e[n].outDegree(t)})),g=n.filter((t=>{for(let n=0;n<e.length;n++)return 0!==e[n].inDegree(t)}));for(let t=0;t<e.length;t++)e[t].directed()&&(u=!0);if(u||(h=g),n.length<3)return[h,g,Kt(e,h,g)];o?o%2==1&&o++:o=24;let d,p=r(g),m=Kt(e,h,g),M=h.slice(),v=g.slice(),b=0;const x=t=>p[t.source==d?t.target.index:t.source.index];function _(t){return(e,n)=>{let r=a[e]-a[n];return 0===r&&(r=t.edges(n).length%2-t.edges(e).length%2),r<0?-1:r>0?1:0}}for(f=h,i=0;i<o;i++,f=f==h?g:h){a={};for(let t=0;t<e.length;t++){c=e[t].nodes();for(let n=0;n<f.length;n++)d=c[f[n]],0===t&&(a[d.index]=[]),s=f==h?e[t].outEdges(d.index):e[t].inEdges(d.index),s=s.map(x),s.length>0&&a[d.index].push(+Jt(s))}c=e[0].nodes();for(let t=0;t<f.length;t++)d=c[f[t]],a[d.index].length>0?a[d.index]=Jt(a[d.index]):a[d.index]=0;f.sort(_(e[0]));for(let t=0;t<f.length;t++)p=r(f);l=Kt(e,h,g),l<m&&(m=l,M=h.slice(),v=g.slice(),b=i,o=Math.max(o,i+2))}return t.debug&&console.log(`Best iter: ${b}`),[M,v,m]}function Zt(){let e=null,n=$t.euclidean,r="complete",o={},l={};function i(t){return null===t?[]:t.id in o?o[t.id]:o[t.id]=function(t){if(null===t)return[];if(0===t.depth)return[t.id];return i(t.left).concat(i(t.right))}(t)}function f(t,n,r){const o=`k${t.id}-${n}-${r}`;return o in l?l[o]:l[o]=function(t,n,r){if(0===t.depth)return[0,[t.id]];const o=t.left,l=t.right,s=i(o),a=i(l);let c,u;if(s.includes(n)&&a.includes(r))c=o,u=l;else{if(!a.includes(n)||!s.includes(r))throw{error:`Node is not common ancestor of ${n}, ${r}`};c=l,u=o}const h=i(c.left),g=i(c.right);let d=g.includes(n)?h:g;0===d.length&&(d=[n]);const p=i(u.left),m=i(u.right);let M=m.includes(r)?p:m;0===M.length&&(M=[r]);let v=1/0,b=[];for(let t=0;t<d.length;t++){const o=f(c,n,d[t]);for(let n=0;n<M.length;n++){const l=f(u,M[n],r),i=o[0]+e[d[t]][M[n]]+l[0];i<v&&(v=i,b=o[1].concat(l[1]))}}return[v,b]}(t,n,r)}function s(n){o={},l={};let r=1/0,s=[];const a=i(n.left),c=i(n.right);t.debug&&console.log(kt(n,0));for(let t=0;t<a.length;t++)for(let e=0;e<c.length;e++){const o=f(n,a[t],c[e]);o[0]<r&&(r=o[0],s=o[1])}return e=null,s}function a(t){null===e&&(e=qt().distance(n)(t));return s(Ut().linkage(r).distanceMatrix(e)(t))}return a.order=s,a.reorder=a,a.distance=function(t){return arguments.length?(n=t,e=null,a):n},a.linkage=function(t){return arguments.length?(r=t,a):r},a.distance_matrix=function(t){return arguments.length?(e=t.map((t=>t.slice(0))),a):e},a.distanceMatrix=a.distance_matrix,a}function te(t,e){if(0===t.length)return null;t=function(t){const e=t.length;if(0===e)return null;const n=Yt(t),r=n.length,o=Array(e);for(let l=0;l<e;l++){const e=t[l].slice(0);for(let t=0;t<r;t++)e[t]-=n[t];o[l]=e}return o}(t);return Dt(vt(t),e)}function ee(n,r){r||(r=e(n.length));const o=pt.pearsonMatrix(n),l=o.map((t=>t.map(Math.abs)));const i=Zt().distanceMatrix(l)(n),f=Ft(r,i),s=function(e,n){const r=[1];let o=1,l=0;for(let t=1;t<e.length;t++)n[e[t-1]][e[t]]<0&&(o=-o),o<0?(r.push(-1),l++):r.push(1);if(t.debug&&console.log(r),l>e.length/2)for(let t=0;t<e.length;t++)r[t]=-r[t];return r}(i,o);return[f,s,i,o]}t.adjacent_exchange=function(t,e,n){e=e.slice(),n=n.slice();const i=r(e),f=r(n);let s=!0,a=0;for(;s;){s=!1;for(let n=0;n<e.length-1;n++){const r=e[n],o=e[n+1],c=l(t,r,o,f),u=l(t,o,r,f);c>u&&(e[n]=o,e[n+1]=r,i[o]=n,i[r]=n+1,s=!0,a+=c-u)}for(let e=0;e<n.length-1;e++){const r=n[e],l=n[e+1],c=o(t,r,l,i),u=o(t,l,r,i);c>u&&(n[e]=l,n[e+1]=r,f[l]=e,f[r]=e+1,s=!0,a+=c-u)}}return[e,n,a]},t.all_pairs_distance=K,t.all_pairs_distance_bfs=function(t,e){e||(e=[t.nodes_indices()]);const n=e.reduce(C).sort(Y),r=Array(n.length);for(let t=0;t<n.length;t++)r[t]=Array(n.length);for(let e=0;e<n.length;e++){const n=ot(t,e);for(let t in n)r[e][t]=n[t],r[t][e]=n[t]}return r},t.all_pairs_distance_floyd_warshall=W,t.array1d=J,t.array_to_dicts=function(t,n=e(t[0].length)){const r=[];for(let e=0;e<t.length;e++){const o=t[e],l={};for(let t=0;t<o.length;t++)l[n[t]]=o[t];r.push(l)}return r},t.assert=wt,t.bandwidth=function(t,n){n||(n=e(t.nodes().length));const o=r(n),l=t.links();let i=0;for(let t=0;t<l.length;t++){const e=l[t],n=Math.abs(o[e.source.index]-o[e.target.index]);i=Math.max(i,n)}return i},t.bandwidth_matrix=function(t){let e=0;for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)t[n][r]>0&&(e=Math.max(e,Math.abs(n-r)));return e},t.barycenter=et,t.barycenter_order=function(t,e,n){let r=[[],[],0];e||(e=t.components());for(let o=0;o<e.length;o++){const l=et(t,e[o],n);r=[r[0].concat(l[0]),r[1].concat(l[1]),r[2]+l[2]]}return r},t.bfs=rt,t.bfs_distances=ot,t.bfs_order=(t,e)=>{e||(e=t.components());const n=[];for(let r=0;r<e.length;r++){rt(t,e[r][0],((t,e)=>{e>=0&&t!=e&&n.push(t)}))}return n},t.ca=dt,t.ca_decorana=gt,t.ca_order=function(t){const e=dt(t);return{rows:lt(e.rows),cols:lt(e.cols),details:e}},t.check_distance_matrix=function(t,e){const n=t.length;if(e||(e=1e-10),n!=t[0].length)return"Inconsistent dimensions";for(let r=0;r<n-1;r++){const o=t[r];let l=o[r];if(l<0)return`Negative value at diagonal ${r}`;if(l>e)return`Diagonal not zero at ${r}`;for(let i=1;i<n;i++){l=o[i];const n=t[i][r];if(Math.abs(l-n)>e)return`Inconsistency at ${r},${i}`;if(l<0)return`Negative value at ${r},${i}`;if(n<0)return`Negative value at ${i},${r}`}}return!1},t.cmp_number=Y,t.cmp_number_asc=G,t.cmp_number_desc=function(t,e){return e-t},t.complete_graph=Bt,t.condition=function(t){let e,n;const r=[];for(let o=0;0<t.length;o++){const l=t[o].slice();let i;for(l.push(r),i=0;i<r.length;i++){if(null!==l[i]){e=n=l[i];break}}for(;i<r.length;i++){const t=l[i];t<e?e=t:t>n&&(n=t)}const f=n!=e?1/(n-e):0;for(i=1;i<r.length;i++){const t=l[i];null!==t&&t>=t&&(l[i]=l[i]*f-e)}}return r},t.correlation=pt,t.count_all_crossings=Kt,t.count_crossings=Z,t.count_in_crossings=o,t.count_out_crossings=l,t.covariance=mt,t.covariancetranspose=Mt,t.cuthill_mckee=bt,t.cuthill_mckee_order=function(t,e){let n,r=[];e||(e=t.components());for(let o=0;o<e.length;o++)n=e[o],r=r.concat(bt(t,n));return r},t.dicts_to_array=function(t,e=Object.keys(t[0])){const n=e.length,r=t.length,o=Array(r);for(let l=0;l<r;l++){const r=Array(n);o[l]=r;for(let o=0;o<n;o++)r[o]=t[l][e[o]]}return o},t.displaymat=function(t,e,n){console.log("Matrix:");for(let r=0;r<t.length;r++){const o=e?t[e[r]]:t[r];let l="";for(let t=0;t<o.length;t++){l+=(n?o[n[t]]:o[t])?"*":" "}console.log(l)}},t.dist=qt,t.dist_remove=zt,t.distance=$t,t.distmat2valuemat=Rt,t.distmax=Nt,t.distmin=function(t){let e=1/0;const n=t.length;for(let r=0;r<n;r++){const o=t[r];for(let t=r+1;t<n;t++)o[t]<e&&(e=o[t])}return e},t.dot=B,t.edgesum=function(t,n){n||(n=e(t.nodes().length));const o=r(n),l=t.links();let i=0;for(let t=0;t<l.length;t++){const e=l[t];i+=Math.abs(o[e.source.index]-o[e.target.index])}return i},t.fiedler_vector=Pt,t.fix_distance_matrix=function(t,e){const n=t.length;if(e||(e=1e-10),n!=t[0].length)throw`Inconsistent dimensions ${n} != ${t[0].length}`;for(let r=0;r<n-1;r++){const o=t[r];let l=o[r];if(l<0){if(-l>e)throw`Negative value at diagonal${r}`;l=o[r]=0}else if(l>e)throw`Diagonal not zero at ${r}`;for(let i=1;i<n;i++){l=o[i];let n=t[i][r];if(Math.abs(l-n)>e)throw`Inconsistency at ${r},${i}`;l<0&&(l=0),n<0&&(n=0),l!=n&&(l+=n,l/=2),o[i]=l,t[i][r]=l}}return t},t.flatten=C,t.floyd_warshall_path=function(t,e,n){if(void 0===t[e][n])return[];const r=[e];for(;e!=n;)e=t[e][n],r.push(e);return r},t.floyd_warshall_with_path=function(t,e){e||(e=t.components()[0]);const n=H(e.length,e.length),o=Array(e.length),l=t.directed(),i=r(e);for(let t=0;t<e.length;t++)n[t][t]=0,o[t]=Array(e.length);const f=e=>{if(e.source==e.target)return;const r=i[e.source.index],f=i[e.target.index];n[r][f]=t.distance(e),o[r][f]=f,l||(n[f][r]=t.distance(e),o[f][r]=r)};for(let n=0;n<e.length;n++)t.edges(e[n]).forEach(f);for(let t=0;t<e.length;t++)for(let r=0;r<e.length;r++)for(let i=0;i<e.length;i++)n[r][i]>n[r][t]+n[t][i]&&(n[r][i]=n[r][t]+n[t][i],o[r][i]=o[r][t],l||(n[i][r]=n[r][i],o[i][r]=o[t][i]));return[n,o]},t.graph=Tt,t.graph2mat=function(t,e){const n=t.nodes(),r=t.links(),o=n.length;let l;if(e||(e=t.directed()),e){let e=o,n=o;for(let n=o-1;n>=0&&0===t.inEdges(n).length;n--)e--;for(let e=o-1;e>=0&&0===t.outEdges(e).length;e--)n--;l=a(e,n);for(let t=0;t<r.length;t++){const e=r[t];l[e.source.index][e.target.index]=e.value?e.value:1}}else{l=a(o,o);for(let t=0;t<r.length;t++){const e=r[t];l[e.source.index][e.target.index]=e.value?e.value:1,l[e.target.index][e.source.index]=e.value?e.value:1}}return l},t.graph2valuemats=function(t,e){return e||(e=t.components()),K(t,e).map(Rt)},t.graph_connect=function(t,e){const n=t.links();e||(e=t.components());for(let t=0;t<e.length-1;t++)for(let r=t+1;r<e.length;r++)n.push({source:e[t][0],target:e[r][0]});return t.links(n),t.init()},t.graph_empty=Vt,t.graph_empty_nodes=St,t.graph_random=Qt,t.graph_random_erdos_renyi=Lt,t.hcluster=Ut,t.infinities=H,t.intersect_sorted_ints=function(t,e){let n=0,r=0;const o=[];for(;n<t.length&&r<e.length;)t[n]<e[r]?n++:(t[n]>e[r]||(o.push(n),n++),r++);return o},t.inverse_permutation=r,t.laplacian=Gt,t.length=L,t.linear_arrangement=function(t){let e=0;for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)n!==r&&t[n][r]>0&&(e+=Math.abs(n-r));return e},t.mat2graph=function(t,e){const n=t.length,r=[],o=[];let l=Number.NEGATIVE_INFINITY;for(let t=0;t<n;t++)r.push({id:t});for(let i=0;i<n;i++){const n=t[i];for(let t=e?0:i;t<n.length;t++)t==r.length&&r.push({id:t}),0!==n[t]&&(n[t]>l&&(l=n[t]),o.push({source:i,target:t,value:n[t]}))}return Tt(r,o,e).linkDistance((t=>1+l-t.value)).init()},t.mean=X,t.meancolumns=Yt,t.meantranspose=function(t,e){const n=t.length;if(0===n)return NaN;let r=0,o=-1;for(;++o<n;)r+=(t[o][e]-r)/(o+1);return r},t.morans_i=function(t){const e=t.length*t.length,n=(t.length-2)*(t.length-2)*4+3*(t.length-2)*2+3*(t.length-2)*2+8;let r=0;for(let e=0;e<t.length;e++)for(let n=0;n<t[0].length;n++)r+=t[e][n];const o=r/e;let l=0,i=0;for(let e=0;e<t.length;e++)for(let n=0;n<t[0].length;n++){i+=Math.pow(t[e][n]-o,2);let r=0;for(let l=Math.max(0,e-1);l<Math.min(t.length,e+2);l++)for(let i=Math.max(0,n-1);i<Math.min(t[0].length,n+2);i++)l===e&&i===n||(n-i>=-1&&n-i<=1&&e===l&&(r+=(t[e][n]-o)*(t[l][i]-o)),n===i&&e-l>=-1&&e-l<=1&&(r+=(t[e][n]-o)*(t[l][i]-o)));l+=r}return 0===l&&0===i?1:e/n*(l/i)},t.mult_adjacent_exchange=function(t,e,n){e=e.slice(),n=n.slice();const o=r(e),l=r(n);let i=!0,f=0;for(;i;){i=!1;for(let n=0;n<e.length-1;n++){const r=e[n],s=e[n+1],a=Ht(t,r,s,l),c=Ht(t,s,r,l);a>c&&(e[n]=s,e[n+1]=r,o[s]=n,o[r]=n+1,i=!0,f+=a-c)}for(let e=0;e<n.length-1;e++){const r=n[e],s=n[e+1],a=Ct(t,r,s,o),c=Ct(t,s,r,o);a>c&&(n[e]=s,n[e+1]=r,l[s]=e,l[r]=e+1,i=!0,f+=a-c)}}return[e,n,f]},t.mult_barycenter=Wt,t.mult_barycenter_order=function(t,e,n){let r=[[],[],0];e=t[0].components();const o=Wt(t,e.flat(),n);return r=[r[0].concat(o[0]),r[1].concat(o[1]),r[2]+o[2]],r},t.mult_dist=function(){let t=$t.euclidean;function e(e,n){const r=e.length,o=[];for(let t=0;t<e[0].length;t++){const t=[];for(let n=0;n<e[0][0].length;n++)t.push(0);o.push(t)}for(let l=0;l<r;l++){t=n[l];let r=[];const i=e[l],f=i.length;for(let e=0;e<f;e++){const n=[];r[e]=n;for(let o=0;o<f;o++)n[o]=o<e?r[o][e]:e===o?0:t(i[e],i[o])}for(let t=0;t<r.length;t++)for(let e=0;e<r[0].length;e++)o[t][e]+=r[t][e]}return o}return e.distance=function(n){return arguments.length?(t=n,e):t},e},t.nn_2opt=function(){let t=null,e=$t.euclidean,n=1e-4;function r(r){null===t&&(t=qt().distance(e)(r));let l=Number.MAX_VALUE,i=[];for(let e=0;e<t.length;e++){let r=[];for(r.push(e);r.length<t.length;){let e=-1;for(let n=0;n<t.length;n++)if(!r.includes(n)){let o=r[r.length-1];(-1===e||t[o][n]<t[o][e])&&(e=n)}r.push(e)}let f=o(r),s=f-1.0001,a=Number.MAX_VALUE,c=[];for(;f-s>n;){for(let e=0;e<r.length;e++)for(let n=e+2;n<r.length-1;n++){let o=t[r[e]][r[e+1]]+t[r[n]][r[n+1]];if(t[r[e]][r[n]]+t[r[e+1]][r[n+1]]<o){let t=[];for(let e=0;e<r.length;e++)t[e]=r[e];for(let o=0;o<=n-(e+1);o++)t[e+1+o]=r[n-o];r=t}}s=f,f=o(r),f<a&&(a=f,c=r)}a<l&&(l=a,i=c)}return i}function o(e){let n=0;for(let r=0;r<e.length-1;r++)n+=t[e[r]][e[r+1]];return n}return r.distance=function(n){return arguments.length?(e=n,t=null,r):e},r.distance_matrix=function(e){return arguments.length?(t=e.map((t=>t.slice(0))),r):t},r.distance=function(n){return arguments.length?(e=n,t=null,r):e},r.distanceMatrix=r.distance_matrix,r},t.normalize=Q,t.optimal_leaf_order=Zt,t.order=function(){let t,r=$t.euclidean,o=Zt,l="complete",i=null,f=[],s=0,a=0,c=1/0;function u(u){t=u,c=Math.min(c,u.length);let g=a>0?a-1:0,d=c<t.length?c+1:c;for(let t=f.length-1;t>0;t-=2){let e=f[t-1],n=f[t];n>=d?d>c?(d=Math.min(d,e+1),f.splice(t-1,2)):n=d:e<=g?g<a?(g=Math.max(g,n-1),f.splice(t-1,2)):e=g:n-e<3&&f.splice(t-1,2)}try{return function(r,o){const l=t;if(t=t.slice(r,o),0===a&&c==t.length)return h();s&&console.log(`i0=${r} j0=${o}`);null!==i?(o!==t.length&&zt(i,o,t.length),r>0&&zt(i,0,r)):M();let u=Nt(i);if(r<a){const t=i[0];for(let e=t.length;e-- >1;)t[e]+=u;for(let t=i.length;t-- >1;)i[t][0]+=u;if(u+=u,0!==r)for(let t=0;t<f.length;t++)f[t]-=r}if(o>c){const t=i.length-1,e=i[t];for(let n=t;n-- >0;)e[n]+=u,i[n][t]+=u}let g=h();r<a?(0!==g[0]&&g.reverse(),o>c?wt(0===g[0]&&g[g.length-1]==g.length-1,"Invalid constrained permutation endpoints"):wt(0===g[0],"Invalid constrained permutation start")):o>c&&(g[g.length-1]!==g.length-1&&(g=g.reverse()),wt(g[g.length-1]==g.length-1,"Invalid constrained permutation end"));0!==r&&(g=n(r).concat(g.map((t=>t+r))));l.length>o&&(g=g.concat(e(o,l.length)));return g}(g,d)}finally{r=$t.euclidean,o=Zt,l="complete",i=null,t=null,f=[],a=0,c=1/0}}function h(){let n,r,o,l,a,c;if(0===f.length)return g();for(M(),r=f.length-1;r>0;r-=2)l=f[r-1],a=f[r],i=zt(i,l+1,a-1),t.splice(l+1,a-l-2),s&&console.log(`Except[${l}, ${a}]`),0!==i[l][l+1]&&(i[l][l+1]=i[l+1][l]=-1);for(n=g(),r=0;r<f.length;r+=2){for(l=f[r],a=f[r+1],o=0;o<n.length;o++)n[o]>l?n[o]+=a-l-2:n[o]==l&&(c=o);if(c>0&&n[c-1]==a-1)Array.prototype.splice.apply(n,[c,0].concat(e(a-2,l,-1)));else{if(n[c+1]!=a-1)throw"Range not respected";Array.prototype.splice.apply(n,[c+1,0].concat(e(l+1,a-1)))}}return n}function g(){let e,n,r,f,a,c,u,h,g=!1;const p=[],v={};for(M(),a=0;a<i.length-1;a++){for(n=i[a],r=[],f=n.indexOf(-1),-1!==f&&(v[a]=[a,f],g=!0),c=n.length;--c>a;)0===n[c]?(f=i[c].indexOf(-1),-1!==f&&(v[a]=[c,f],i[f][a]=n[f]=-1,g=!0),r.unshift(c),i=zt(i,c),t.splice(c,1)):n[c]<0&&(g=!0);0!==r.length&&(r.unshift(a),p.push(r))}if(g)for(a=0;a<i.length-1;a++)for(n=i[a],c=a+1;c<n.length-1;c++)-1==i[c][c+1]&&(i[c+1][c]=i[c][c+1]=0);for(e=function(){s>1&&yt(i);s>2&&yt(t);const e=o().linkage(l).distanceMatrix(i)(t);s&&console.log(`Permutation: ${e}`);return e}(),a=p.length;a-- >0;)for(r=p[a],c=e.indexOf(r[0]),u=v[r[0]],u&&u[0]==r[0]&&(c=d(e,c,u[0],u[1],0),u=void 0),h=1;h<r.length;h++)e=m(e,c,r[h]),u&&u[0]==r[h]&&(c=d(e,c,u[0],u[1],h),u=void 0);return e}function d(t,e,n,r,o){if(e>0&&t[e-1]==r)return p(t,e,t.indexOf(n)),e+1;if(t[e+o+1]==r)return p(t,e+o,t.indexOf(n)),e;throw"Index not found"}function p(t,e,n){if(e==n)return;const r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n){return(t=t.map((t=>t<n?t:t+1))).splice(e,0,n),t}function M(){return null===i&&(i=qt().distance(r)(t)),i}return u.debug=function(t){return 0!=arguments.length&&(s=t),s},u.distance=function(t){return arguments.length?(r=t,u):r},u.linkage=function(t){return arguments.length?(l=t,u):l},u.limits=function(t,e){return arguments.length?(a=t,c=e,u):[a,c]},u.except=function(t){let e;if(!arguments.length)return f.slice(0);for(e=1;e<t.length;e++)if(t[e-1]>=t[e])throw"Invalid list, indices not sorted";return f=t.slice(0),u},u.orderrowsexcept=function(t,n,l){const i=qt().distance(r)(t);let f,s,a,c=!1,u=-1;i[n][n+1]=0,i[n+1][n]=0;const h=o().distanceMatrix(i)(t);for(u=h.indexOf(n),f=0;f<h.length;f++)s=h[f],s>n&&(h[f]+=l-n-2);return 0!==u&&h[u-1]===l-1&&(c=!0),c&&(h.reverse(),u=h.length-u-1),a=[u+1,0].concat(e(n+1,l-1)),Array.prototype.splice.apply(h,a),h},u},t.parcoords=function(t){t.detectDimensions().autoscale();const e=t.data(),n=t.types(),r=t.hideAxis(),o=t.yscale,l=[],i=[];let f=t.dimensions();for(let t=0;t<f.length;t++){const s=f[t];if(r.includes(s))f.splice(t,1),l.push(s),t--;else if("number"==n[s]||"date"==n[s]){const t=[],n=o[s];for(let r=0;r<e.length;r++)t.push(n(e[r][s]));i.push(t)}else f.splice(t,1),l.push(s),t--}const[s,a]=ee(i,f);f=s.concat(l.reverse()),t.dimensions(f),t.hideAxis(r);for(let e=0;e<a.length;e++)a[e]<0&&t.flip(f[e])},t.parcoords_es=function(t){const e=t.dimensions(),n=t.data(),r=[],o=[],l=[];for(const t in e){const i=e[t];if("number"==i.type||"date"==i.type){const e=[],r=i.yscale;for(let o=0;o<n.length;o++)e.push(r(n[o][t]));l.push(e),o.push(t)}else r.push(t)}const[i,f]=ee(l,o),s=i.concat(r.reverse());t.xscale.domain(s),t.sortDimensions();for(let e=0;e<f.length;e++)f[e]<0&&t.flip(s[e])},t.pca1d=te,t.pca_order=function(t,e){return lt(te(t,e))},t.pcp=ee,t.permutation=n,t.permute=Ft,t.permute_inplace=function(t,e){for(let n=0;n<t.length;n++){let r=e[n];if(r<0){e[n]=-1-r;continue}let o=n;for(;r!=n;){let n=t[r];t[r]=t[o],t[o]=n,o=r,n=e[r],e[r]=-1-n,r=n}}return t},t.permute_matrix=function(t,e,n){n||(n=e);let r=[];for(let o=0;o<t.length;o++){r.push([]);for(let l=0;l<t[0].length;l++)r[o].push(t[e[o]][n[l]])}return r},t.permutetranspose=function(t,e){let n=t.length;for(;n-- >0;)t[n]=Ft(t[n],e);return t},t.poweriteration=Dt,t.poweriteration_n=Ot,t.printhcluster=kt,t.printmat=yt,t.printvec=_t,t.profile=function(t){let e=0;for(let n=0;n<t.length;n++){let r=t.length;for(let e=0;e<t.length;e++)t[n][e]>0&&e<r&&(r=e);r<n&&(e+=n-r)}return e},t.randomPermutation=function(t){return Et(n(t))},t.randomPermute=Et,t.random_array=jt,t.random_matrix=function(t,e,n,r){n||(n=e),e!=n?r=!1:r||(r=!0);const o=a(e,n);if(r)for(let n=0;n<e;n++){let r=0;for(let e=0;e<n+1;e++)Math.random()<t&&(o[n][e]=o[e][n]=1,r++);if(0===r){const t=Math.floor(Math.random()*e/2);o[n][t]=o[t][n]=1}}else for(let r=0;r<e;r++){let e=0;for(let l=0;l<n;l++)Math.random()<t&&(o[r][l]=1,e++);0===e&&(o[r][Math.floor(Math.random()*n)]=1)}return o},t.range=e,t.reverse_cuthill_mckee=xt,t.reverse_cuthill_mckee_order=function(t,e){let n,r=[];e||(e=t.components());for(let o=0;o<e.length;o++)n=e[o],r=r.concat(xt(t,n));return r},t.set_debug=function(e=!0){t.debug=e},t.sort_order=lt,t.sort_order_ascending=it,t.sort_order_descending=function(t){return n(0,t.length).sort(((e,n)=>t[n]-t[e]))},t.spectral_order=function(t,e){let n=[];e||(e=t.components());for(let r=0;r<e.length;r++){const o=e[r],l=lt(Pt(Gt(t,o)));n=n.concat(Ft(o,l))}return n},t.stablepermute=function(t,e){const n=Ft(t,e);return n[0]>n[n.length-1]&&n.reverse(),n},t.sum=function(t){let e=t.length,n=0;for(;e-- >0;)isNaN(t[e])||(n+=t[e]);return n},t.transpose=U,t.transposeSlice=function(t,e=0,n=t[0].length){const r=t.length,o=n,l=new Array(n-e);let i=e-1;for(;++i<o;){l[i]=new Array(r);let n=-1;for(;++n<r;)l[i-e][n]=t[n][i]}return l},t.union=function(t){let e=[];for(let n=0;n<t[0].length;n++){e[n]||e.push([]);for(let r=0;r<t[0][0].length;r++){e[n].length<t[0][0].length&&e[n].push(0);for(let o=0;o<t.length;o++)e[n][r]=e[n][r]+t[o][n][r]}}return e},t.valuemats_reorder=function(t,e,n){let r=t.map(e);return n&&(r=r.map(((t,e)=>Ft(n[e],t)))),r.reduce(C)},t.variancecovariance=vt,t.version="2.2.5",t.zeroes=a,Object.defineProperty(t,"__esModule",{value:!0})}));
